# Программирование на языке R

#### Аннотация
Язык R — современный язык программирования предназначенный для статистического анализа большого объёма данных. На данный момент R является одним из самых используемых языков программирования в биоинформатике. Цель курса - освоить базовый синтаксис языка R, познакомиться с структурами данных, управляющими конструкциями и графическими возможностями. Курс включает в себя знакомство с функциями R предназначенными для выполнения основных статистических тестов, освоение базовой графики и знакомство с некоторыми биоинформатическими пакетами из Bioconductor.


#### Формула Оценки
ДЗ * 0.6 + Кр1 * 0.2 + Кр2 * 0.2

#### Полезные ссылки
- [ПУД](https://www.hse.ru/edu/courses/900081242)
- [R](https://www.r-project.org/)
- [Rstudio](https://posit.co/download/rstudio-desktop/)

## Лекции


## Домашние Задания

отправлять на [voytetskiyartem@gmail.com](mailto:voytetskiyartem@gmail.com) (тема R2024) в .R в UTF-8

### HW1

Прочитать файл ([hw1.txt](https://github.com/Vladm0z/HSE-Bioinformatics/blob/main/Bioinformatics/MSc/introR/hw1.txt)) (содержит три колонки — уровни экспрессии трех генов в различных условиях, блокнот под windows может открывать его не правильно, но R должен читать)

выяснить
- есть ли зависимость между экспрессиями в какой-либо паре генов
- есть ли отличия в средней экспрессии между какой либо парой генов

Представить ответ в виде кода (файл с расширением .R). Он должен включать:
- список пар генов со значимой зависимостью (закомментированный текст в коде)
- список пар генов со значимыми отличиями среднего (закомментированный текст в коде)
- код необходимый для получения вышеупомянутых списков
- код необходимый для получения картинок иллюстрирующих все вышеперечисленное

### HW2

- Оцените эмпирически вероятность точки случайно равномерно распределенной на квадрате [-1,1] * [-1,1] быть удалённой от центра координат не более чем на 1. Используйте 10000 бросков.
- Используя результаты предыдущего пункта, дайте оценку числа рі
- Нарисуйте зависимость оценки числа рі от числа бросков (для одной симуляции, количества бросков выберете сами). Истинное значение числа рі можно найти в переменной рі


### HW3

- К какому типу относится переменная mtcars?
  - К какому типу относится второй столбец из mtcars
  - Сколько цилиндров у Fiat 128? Выведите все машины у которых столько же цилиндров.
  - Какое минимальное число цилиндров встречается? Отберите все машины с минимальным числом цилиндров (для помощи наберите ?mtcars)
  - Посчитайте корреляцию между всеми свойствами машин при помощи cor(mtcars)
  - К какому типу относится результат функции cor из предыдущего задания?
  - с какими свойствами у потребления бензина наблюдается коэффициент корреляции менее -0.7 ?
- Создайте вектор длины 100 заполненный случайными нормально распределенными значениями со средним 40 и дисперсией 10
  - Возьмите подвектор с каждым третьим значением исходного вектора
  - Возьмите подвектор не содержащий каждое пятое значение исходного вектора
  - Возьмите подвектор содержащий только числа с четной целой частью
- Придумайте структуру (на основе list) для хранения информации (взаимное расположение листьев дерева) о представленном ниже дереве. Получите из этой структуры вектор с именами всех листьев. Извлеките левое поддерево. Извлеките узел с листьями b и с.
```
       /   \
     / \     \
   /  / \    / \
  A  B   C  D   E
```

### HW4

Скачайте [геном E.coli в формате fasta](https://www.ncbi.nlm.nih.gov/nuccore/NC_011750.1?report=fasta), прочитайте его методом read.dna из пакета ape. Получите последовательность генома в виде строки (строковой вектор единичной длины). Найдите два самых частых и самых редких 6-ти мера в геноме бактерии. Постарайтесь опитимизировать код так, чтобы он работала за адекватное время.

Весьма вероятно, что существуют готовые функции для выполнения это задания, однако в данном ДЗ вам нельзя ими пользоваться (кроме функции read.dna из ape)

### HW5

- Напишите функцию находящую пый по величине элемент вектора
- На основании практического задания, напишите функцию рисующую множество Мандельброта, параметрами которой являются диапазон значений в матрицах х и у, размер матриц и число итераций в пункте 3.
  
Практическое задание:
- Создайте матрицы x0 и у0 размером 1000*1000. Заполните матрицы так, что в $x 0$ все строки одинаковы и содержат последовательные числа от -2 до 1. В у0 одинаковы колонки и они содержат равномерно распределенные числа от -1 до 1
- Сделайте матрицы x и у равные $x 0$ и у0 соответственно
- Пересчитайте матрицы x и у по формуле (обратите внимание на то, что новые значения х и у зависят от СТАРЫХ x и у):
  
```R
x = x^2 - y^2 + x0
y = 2*x*y + y0
```

- Повторите предыдущий пункт 20 раз
- Выполните:
  
```R
# Calculate the squared distance and transpose the result
z <- t(abs(x^2 + y^2))

# Rank the non-NA values in z
z[!is.na(z)] <- rank(z[!is.na(z)])

# Create an image of z cubed with a reversed terrain color palette
image(z^3, col = rev(terrain.colors(1000)))
```

### HW6

- Отберите из baseball (plyr) записи для команд у которых есть хотя бы 200 записей.
- Рассчитайте матрицу переходов игроков между командами - для каждой пары команд в этой матрице указано сколько есть игроков игравших в обоих командах.
- Поделите каждую ячейку полученной матрицы на размер (количество игроков которые есть в baseball) меньшей (из пары) команды.
- Получите матрицу расстояний вычтя из единицы матрицу полученную на предыдущем шаге.
- Проведите многомерное шкалирование и отрисуйте его результаты ( m - матрица полученная на предыдущем этапе)
  
```R
# Perform classical multidimensional scaling
mds <- cmdscale(m, k = 2)

# Plot the MDS result
plot(mds, pch = 19)

# Add text labels to the plot
text(mds, rownames(mds), adj = c(1.2, 1.2), col = 'red')
```

- Модифицируйте код из предыдущего пункта так, чтобы размер точек был пропорционален размеру команд.

### HW7

- Написать функцию, которая рисует барплот с а) разбросом б) текстом
```R
my.barplot(d=1:5,t=LETTERS[1:5],e=runif(5,max = 3),col='red',border=NA)
```
- Написать функцию, расширяющую возможности image: она должна писать в ячейках текст, и подписывать строки и столбцы в соответствии с row/colnames входной матрицы:
Сделайте пример использования функции, например такой:
```R
d = matrix(1:8,ncol=2)
colnames(d)=c('col1','col2')
rownames(d) = paste0('row',1:4)
par(mfrow=c(1,2))
image(d,col=terrain.colors(100))
imageWithText(d,t = pasteO('x=',d),
    xlab='Cols',ylab='rows',
    main='table',col=terrain.colors(100))
```

### HW8

- Сгенерируйте случайную (нормальное распределение, mean=0,sd=1) матрицу с уровням экспрессии 10000 генов в 5 здоровых образцах
- Сгенерируйте таким же образом такую же матрицу для образцов рака. У первых 500 генов сделайте во всех образцах mean=3
- Постройте рса для объединения матриц (cbind), корреляционный heatmap и mds
- Посчитайте p-value при помощи t.test для каждого гена (сравнение здоровых и раковых)
- Сколько генов значимо при уровне значимости равном 0.05 (т. е. имеют p-value < 0.05)? Чему равна доля ложно-положительных (FDR, false discovery rate, доля генов которые на самом деле не меняются (в нашем случае - не первые 500) среди всех значимых)?
- Какому уровню значимости соответствует FDR=0.05 (поправка ВН). Сколько генов значимо в этом случае? Чему равна реальная доля ложно-положительных?
- Ответьте на вопросы предыдущего пункта, но с использованием поправки Боннферони и тем же порогом на корректированное p-value
- Постройте распределение размера эффекта (разница средних между больными и здоровыми) для генов из шестого пункта. Соответствует ли распределение вашему ожиданию? Ответьте в теле письма и кратко поясните ответ.
- Повторите 1-2, 4 и 6 пункты. Какова воспроизводимость результатов: какую долю генов значимых в первом «эксперименте» вы смогли воспроизвести во втором?
